---
import menuScript from '../lib/fetchMenu.ts?url';
---
<section id="menu" class="section menu-section" aria-live="polite">
  <div class="container">
    <a href="/" class="back-button" aria-label="Zurück zur Startseite">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
      <span>Zurück</span>
    </a>
    <header class="section-header">
      <h2>Unsere Produktauswahl</h2>
      <p class="section-lead">
        Frisch, flexibel & bereit für euer Event
      </p>
    </header>

    <div class="menu-hero__status" aria-live="polite">
      <p id="menu-loading" class="status-pill">Menü wird geladen …</p>
      <p id="menu-error" class="status-pill status-pill--error is-hidden">Fehler beim Laden der Daten. Fallback aktiv.</p>
    </div>

    <div id="menu-categories-container" class="menu-categories" aria-live="polite">
      <p class="menu-empty">Noch keine Produkte geladen.</p>
    </div>

    <section id="menu-debug" class="menu-debug is-hidden" aria-live="polite">
      <div class="menu-debug__header">
        <div>
          <p class="section-lead">Menü-Datenquelle</p>
          <h3>Google Sheet / Static JSON</h3>
        </div>
        <div class="menu-debug__meta" id="menu-debug-status">Wird geladen …</div>
      </div>
      <p class="menu-debug__hint" id="menu-debug-hint">
        Sobald das Menü geladen ist, erscheinen hier Status und Quelle (Sheets API, Sheet-Export, Drive oder Fallback).
        Typische Fehlercodes: 403 (API-Key/Freigabe fehlt) oder 404 (ID/Range nicht gefunden).
      </p>
      <dl class="menu-stats">
        <div class="menu-stats__item">
          <dt class="menu-stats__label">Quelle</dt>
          <dd class="menu-stats__value" id="menu-debug-source">–</dd>
        </div>
        <div class="menu-stats__item">
          <dt class="menu-stats__label">Einträge</dt>
          <dd class="menu-stats__value" id="menu-debug-count">0</dd>
        </div>
        <div class="menu-stats__item">
          <dt class="menu-stats__label">Stand</dt>
          <dd class="menu-stats__value" id="menu-debug-fetched">–</dd>
        </div>
      </dl>
      <details class="menu-json">
        <summary>Letztes Payload</summary>
        <pre class="menu-json__pre" id="menu-debug-payload">Warte auf Daten …</pre>
      </details>
    </section>
  </div>
</section>
<script type="module" src={menuScript} defer></script>
